#!/usr/bin/env sh

generate_ssh_key() {
    # Get the email from gitconfig
    email=$(git config user.email)

    ssh_dir="$XDG_HOME/.ssh"
    mkdir -p "$ssh_dir"

    ssh-keygen -t rsa -b 4096 -C "$email" -f "$ssh_dir/id_rsa"

    eval "$(ssh-agent -s)"

    # Add the newly generated SSH key to the agent
    ssh-add "$ssh_dir/id_rsa"
    cat "$ssh_dir/id_rsa.pub" | wl-copy
    echo "SSH key generated and added to the agent. Public key copied to clipboard."
}

# execute
generate_ssh_key

